---
layout: post
title: 오토에버 클라우드 2기 17일차
tags: ubuntu linux
image: "https://github.com/user-attachments/assets/596ece57-32a4-4529-9170-4f9e66154fb9"
---

### UID(User ID)와 GID(Group ID)

UID는 사용자를 유일하게 식별하는 코드, GID는 그룹을 유일하게 실별하는 코드이다

위 id는 왜 사용할까?

- 일관된 식별: 사용자 이름(username)은 변경될 수 있지만, UID는 시스템 전반에서 고정된 식별자 역할

- 파일·디렉토리 소유권 관리: 소유자(UID), 소유 그룹(GID)에 따라 읽기/쓰기/실행 권한이 달라짐

- 프로세스 권한 분리: 프로세스 실행 시 해당 UID/GID의 권한으로 동작

- 보안: 숫자 기반 식별로 충돌 방지 및 권한 격리

| 용도           | 파일/명령어                      | 설명                                 |
| -------------- | -------------------------------- | ------------------------------------ |
| 사용자 정보    | `/etc/passwd`                    | 사용자별 UID, 홈디렉토리, 셸 등 저장 |
| 비밀번호 정보  | `/etc/shadow`                    | 암호화된 패스워드 + 에이징 정보 저장 |
| 그룹 정보      | `/etc/group`                     | 그룹별 GID, 구성원 리스트 저장       |
| 조회           | `id <사용자>` / `id`             | 현재 또는 특정 계정의 UID/GID 출력   |
| 생성·수정      | `useradd` / `usermod -u <UID>`   | 계정 생성 및 UID 변경                |
| 그룹 생성·수정 | `groupadd` / `groupmod -g <GID>` | 그룹 생성 및 GID 변경                |

&nbsp;

``` bash
master1@master1-vm:/home$ id master1
uid=1000(master1) gid=1000(master1) groups=1000(master1),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),101(lxd)
```

&nbsp;

### 패스워드 에이징(Password Aging)

사용자 비밀번호의 만료 주기를 설정하여 일정 기간이 지나면 반드시 변경하도록 강제하는 기능

- 최소 사용 기간(Minimum days): 비밀번호 변경 후 최소 유지 일수

- 최대 사용 기간(Maximum days): 비밀번호 만료까지 허용 일수

- 경고 기간(Warning days): 만료 전 사용자에게 알림 시작 일수

- 비활성 기간(Inactive days): 만료 후 로그인 불가 전 추가 유예 일수

| 용도      | 파일/명령어         | 설명                                       |
| --------- | ------------------- | ------------------------------------------ |
| 기본 정책 | `/etc/login.defs`   | 신규 계정 생성 시 기본 에이징 값 설정      |
| 조회      | `chage -l <사용자>` | 해당 계정의 패스워드 에이징 설정 현황 조회 |
| 설정      | `chage` 옵션        | 직접 일수 변경 가능                        |
| 일괄 정책 | `useradd -D`        | useradd 기본 에이징 값 확인/변경           |

<center>
<img src="https://github.com/user-attachments/assets/596ece57-32a4-4529-9170-4f9e66154fb9" style="zoom:80%;">
</center>

&nbsp;

``` bash
sudo useradd -m mini # 계정 생성
# m 옵션은 사용자의 홈 디렉토리를 자동으로 생성하라는 의미

tail /etc/passwd # 계정 생성 확인
#uuidd:x:104:105::/run/uuidd:/usr/sbin/nologin
#tcpdump:x:105:107::/nonexistent:/usr/sbin/nologin
#tss:x:106:108:TPM software stack,,,:/var/lib/tpm:/bin/false
#landscape:x:107:109::/var/lib/landscape:/usr/sbin/nologin
#fwupd-refresh:x:989:989:Firmware update daemon:/var/lib/fwupd:/usr/sbin/nologin
#usbmux:x:108:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
#sshd:x:109:65534::/run/sshd:/usr/sbin/nologin
#master1:x:1000:1000:master1:/home/master1:/bin/bash
#user1:x:1001:1001::/home/user1:/bin/sh
#mini:x:1002:1002::/home/mini:/bin/sh

sudo passwd mini # 생성한 계정 비밀번호 설정

#필요한 권한 설정(useradd)
whereis useradd # useradd 명령어 위치를 확인
#useradd: /usr/sbin/useradd /usr/share/man/man8/useradd.8.gz

sudo visudo #명령으로 sudoers 파일을 수정
	mini ALL=/ust/sbin/useradd #코드 넣기
	
su - mini #계정 변경

sudo useradd kkk # 계정 생성

sudo userdel -f mini # 계정 삭제
```

