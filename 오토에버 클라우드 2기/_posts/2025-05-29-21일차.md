---
layout: post
title: 오토에버 클라우드 2기 21일차
tags: 네트워크
---

### 프로토콜

- **프로토콜**: 통신 규칙, 규약, 약속
- **프로토콜 스택**: 단일 프로토콜이 아닌 여러 개의 프로토콜을 계층적으로 구성한 형태

&nbsp;

#### 대표적인 스택
- **TCP/IP 스택**: 현재 네트워크의 표준. 5계층 모델
- **OSI 7계층**: 통신 규약의 표준화 목적

Application - Data,
Presentation - Data,
Session - Data,
Transport - Segment,
Network - Packet,
DataLink - Frame,
Physical - Bit,

- **개발자**: 하향식(상위 → 하위 계층)으로 네트워크 접근  
- **네트워크 엔지니어**: 상향식(하위 → 상위 계층)으로 접근  
- 4계층(Transport)을 기준으로 위는 상위 계층, 아래는 하위 계층

&nbsp;

### TCP/IP 스택 (4계층 구조)

- **Application**: OSI 상위 3계층 합침 (Application, Presentation, Session)
- **Transport**
- **Internet**: OSI Network 계층
- **Network Access**: OSI DataLink + Physical 계층

&nbsp;

### 각 계층 역할 요약

- **Physical**: 물리적 신호 전달 (장비: 허브)
- **Data Link**: Mac Address 기반 목적지 확인 (장비: 스위치)
- **Network**: IP 주소 기반 라우팅, 네트워크 구분 (장비: 라우터, L3 스위치)
- **Transport**: 데이터 신뢰성 보장 (장비: 로드밸런서)
- **Session**: 연결 유지/종료, 에러 복구, 재전송
- **Presentation**: 데이터 압축, 암호화
- **Application**: 서비스 계층

&nbsp;

### 네트워크 규모

- **LAN**: 근거리 네트워크
- **MAN**: 도시 규모 네트워크 (현재는 WAN으로 통합되는 경향)
- **WAN**: 광역 네트워크
- **PAN**: 개인용 네트워크

&nbsp;

### 회선 종류

- **인터넷 회선**: 광케이블 (Gbps), 동축 케이블 (100Mbps)
- **전용회선**: 대역폭 보장. LLCF 기능 포함
- **VPN (Virtual Private Network)**: 공용망에서 사설망처럼 사용하는 기술

&nbsp;

### 물리적 구성요소

- **NIC, 케이블, 커넥터, 허브, 스위치, 라우터, 로드밸런서, 방화벽, 모뎀, 공유기 등**

#### 주요 장비 역할
- **허브**: 브로드캐스트 방식 (주소 기억 불가)
- **스위치**: 목적지 MAC 기억 → 유니캐스트 가능
- **라우터**: 외부 경로 설정, 네트워크 분리
- **로드밸런서 (L4 Switch)**: 부하 분산
- **방화벽/IPS**: 접근 제어 및 보안

&nbsp;

### 통신 방식

| 방식      | 설명                                       |
| --------- | ------------------------------------------ |
| Unicast   | 1:1 통신                                   |
| Broadcast | 동일 네트워크 내 모든 호스트               |
| Multicast | 특정 그룹 대상 1:N 통신                    |
| Anycast   | 가장 가까운 노드 1:1 통신 (IPv6 완전 지원) |

---

### MAC Address

- 하드웨어에 고정된 주소, NIC 단위 고유 식별자
- 자신이 목적지인 경우만 처리

---

### IP Address

- 3계층 주소: 네트워크 + 호스트 주소
- IPv4: 4개의 8비트 옥텟으로 구성

#### IP 클래스

| 클래스 | 주소 범위                   | 비트 구성   |
| ------ | --------------------------- | ----------- |
| A      | 0.0.0.0 ~ 127.255.255.255   | N:8 / H:24  |
| B      | 128.0.0.0 ~ 191.255.255.255 | N:16 / H:16 |
| C      | 192.0.0.0 ~ 223.255.255.255 | N:24 / H:8  |
| D      | 224.0.0.0 ~ 239.255.255.255 | 멀티캐스트  |
| E      | 240.0.0.0 ~ 255.255.255.255 | 예약        |

- 실제 사용 가능 주소: 전체 범위 - 네트워크 주소 - 브로드캐스트 주소

---

### 클래스리스 주소체계 (CIDR)

- 서브넷 마스크를 사용하여 네트워크를 유연하게 나눔
- `/24`, `/16` 형식으로 표현

---

### NAT (Network Address Translation)

- 사설 IP를 공인 IP로 변환
- 내부 보안을 높이고 IP 절약 가능

---

### Bogon IP

- IANA가 예약해 놓은 IP 범위
- 일반적인 라우터에는 경로 정보 없음 (보안 경계선)

---

### 특별한 IP

| IP 대역        | 설명         |
| -------------- | ------------ |
| 0.0.0.0/8      | This network |
| 10.0.0.0/8     | Private IP   |
| 100.64.0.0/10  | CGNAT        |
| 127.0.0.0/8    | Loopback     |
| 169.254.0.0/16 | Link Local   |
| 172.16.0.0/12  | Private IP   |

---

### TCP / UDP

- **TCP**: 연결 지향, 오류 제어, 재전송 가능, 신뢰성 중요
- **UDP**: 비연결 지향, 빠름, 실시간 스트리밍에 적합

| 구분      | TCP         | UDP                    |
| --------- | ----------- | ---------------------- |
| 연결      | 연결 지향   | 비연결 지향            |
| 오류 제어 | 있음        | 없음                   |
| 흐름 제어 | 있음        | 없음                   |
| 통신 방식 | 유니캐스트  | 유니/멀티/브로드캐스트 |
| 전송 방식 | Full Duplex | Half Duplex            |
| 용도      | 데이터 전송 | 실시간 트래픽          |

---

### ARP (Address Resolution Protocol)

- IP 주소를 MAC 주소로 변환
- 과거 MAC 정보는 ARP 테이블에 저장하여 재사용

#### GARP (Gratuitous ARP)

- 자신의 IP와 MAC을 브로드캐스트하여 IP 충돌 확인

#### RARP (Reverse ARP)

- MAC → IP 변환 요청 (현재는 BOOTP/DHCP로 대체됨)

---

### 서브넷과 게이트웨이

- **서브넷**: 로컬 네트워크 내 주소 구분
- **게이트웨이**: 외부 네트워크로 나갈 때 경로 지정 (3계층 장비)

---

### Switch

- MAC 주소 기반 2계층 장비
- VLAN, STP 등 고급 기능 제공

---

### PDU (Protocol Data Unit)

- 계층별 데이터 단위

| 계층  | 명칭    |
| ----- | ------- |
| 1계층 | Bit     |
| 2계층 | Frame   |
| 3계층 | Packet  |
| 4계층 | Segment |

&nbsp;

### 스위치

스위치는 **이더넷 네트워크에서 통신을 중재하는 장비**로, 장비 간 데이터를 충돌 없이 전송하도록 돕는다.

####  스위치가 없을 때:

- 허브 기반 네트워크에서는 데이터를 전송할 때 **경합(Collision)** 발생 → 성능 저하

####  스위치의 핵심 역할:

- **단말의 MAC 주소**와 **연결된 포트 정보**를 기반으로 통신 경로 결정
- **MAC 주소 테이블**을 통해 정확한 장비에만 프레임 전달

#### MAC 주소 테이블 동작 방식:

1. **Flooding**
   - 목적지 MAC 주소를 모를 때, **수신 포트를 제외한 모든 포트에 데이터 전송**
2. **Address Learning**
   - 수신된 프레임의 **출발지 MAC 주소와 포트 정보**를 학습하여 MAC 주소 테이블에 저장
3. **Forwarding/Filtering**
   - 목적지 MAC 주소가 테이블에 존재하면 해당 포트로만 전송 (Forwarding)
   - 해당 포트가 수신 포트와 동일하면 전송하지 않음 (Filtering)

------

###  VLAN (Virtual LAN)

VLAN은 하나의 물리적 스위치 장비를 **논리적으로 여러 개의 네트워크로 분리**해 주는 기능이다.

####  VLAN의 목적:

- **브로드캐스트 도메인 분리**로 성능 향상
- **보안성 강화**
- 서비스 또는 부서 단위로 **네트워크 정책 분리**

####  VLAN의 특징:

- VLAN 간에는 **브로드캐스트 및 유니캐스트 통신이 불가능**
- 서로 다른 VLAN 간 통신은 반드시 **3계층(라우터 or L3 스위치)** 필요

####  VLAN 종류:

1. **포트 기반 VLAN**
   - 포트에 VLAN ID를 할당 → 해당 포트에 연결된 장비는 자동으로 해당 VLAN 소속
2. **MAC 기반 VLAN**
   - 장비의 MAC 주소를 기준으로 VLAN에 할당

####  VLAN 연결 방식:

- 서로 다른 VLAN이 하나의 링크(포트)로 통신하도록 하려면 **Trunk 포트** 설정 필요
- Trunk 포트는 여러 VLAN의 프레임에 VLAN ID 태그를 붙여 전송함 → Tagged 포트라고도 함

------

###  STP (Spanning Tree Protocol)

스위치 간 이중화 구성 시 **루프 방지**를 위해 사용하는 프로토콜

#### ❗ SPOF (Single Point of Failure: 단일 장애 지점)

- 하나의 장비 또는 경로에 장애가 생기면 **전체 네트워크 중단 가능성**
- 이를 피하기 위해 **이중화 구성**이 필요하지만, 이중화는 루프 발생 위험을 증가시킴

####  STP의 필요성:

- **이중화 구성 시 루프 발생** → 브로드캐스트 폭주(Storm), MAC 테이블 혼란, 네트워크 불능 등
- STP는 **루프 없이** 이중화 경로를 구성하여 **SPOF 제거 + 안정성 확보**

####  STP 동작 원리:

1. **루트 브리지(Root Bridge) 선출**
   - 가장 낮은 Bridge ID를 가진 스위치가 루트로 지정됨
2. **비용 계산**
   - 각 스위치는 루트 브리지까지의 최단 경로 비용 계산
3. **포트 역할 지정**
   - **Root Port**: 루트 브리지로 가는 최단 경로 포트
   - **Designated Port**: 세그먼트당 대표 포트
   - **Blocked Port**: 루프 방지를 위해 비활성화된 포트

####  STP의 특징:

- **자동 복구 기능**: 장애 발생 시 비활성 포트를 활성화하여 트래픽 우회
- **복구 시간**: 기본 STP는 수십 초 소요 → 빠른 복구가 필요한 경우 **RSTP(Rapid STP)** 사용



